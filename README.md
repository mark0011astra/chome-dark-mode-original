# chome-dark-mode-original
chomeをダークモードにするシンプルな拡張機能
## 概要

Dark Mode for Chrome は、Google Chrome 用の拡張機能で、ウェブページをダークモードに変換します。ユーザーは、拡張機能のアイコンをクリックするだけでダークモードのオン/オフを切り替えることができます。また、オプションページでダークモードを永続的に有効または無効にすることもできます。

## ファイル構成

拡張機能は以下のファイルで構成されています：

- `manifest.json`：拡張機能のマニフェストファイル
- `background.js`：バックグラウンドスクリプト
- `content.js`：コンテンツスクリプト
- `dark_mode.css`：ダークモードのスタイルシート
- `options.html`：オプションページの HTML ファイル
- `options.js`：オプションページのスクリプト
- `icon.png`：拡張機能のアイコン

## マニフェストファイル（manifest.json）

`manifest.json`ファイルは、拡張機能のメタデータとパーミッションを定義します。主な要素は以下の通りです：

- `manifest_version`：マニフェストのバージョン（現在は3）
- `name`：拡張機能の名前
- `version`：拡張機能のバージョン
- `description`：拡張機能の説明
- `permissions`：拡張機能が必要とするパーミッション
- `host_permissions`：拡張機能がアクセスできるホストのパターン
- `action`：拡張機能のアクションの定義（アイコンとタイトル）
- `background`：バックグラウンドスクリプトの定義
- `content_scripts`：コンテンツスクリプトの定義（適用するウェブページ、CSS、JS）
- `options_page`：オプションページの定義

## バックグラウンドスクリプト（background.js）

`background.js`ファイルは、拡張機能のメインロジックを担当します。主な機能は以下の通りです：

- ダークモードの初期状態を読み込む
- アイコンのクリックイベントを監視し、ダークモードのオン/オフを切り替える
- アイコンのタイトルをダークモードの状態に応じて更新する
- ストレージの変更を監視し、他のタブに変更を反映する

## コンテンツスクリプト（content.js）

`content.js`ファイルは、ウェブページにインジェクトされ、ダークモードの適用を担当します。主な機能は以下の通りです：

- ダークモードのオン/オフに応じて、`<body>`要素にクラスを追加/削除する
- ストレージからダークモードの設定を読み込み、初期化する

## ダークモードのスタイルシート（dark_mode.css）

`dark_mode.css`ファイルは、ダークモードが有効になったときに適用される CSS スタイルを定義します。主なスタイルは以下の通りです：

- `background-color`：背景色
- `color`：テキスト色
- `a`：リンクの色
- `button`、`input[type="button"]`、`input[type="submit"]`：ボタンの背景色とテキスト色
- `input[type="text"]`、`input[type="password"]`、`textarea`：フォーム要素の背景色とテキスト色

## オプションページ（options.html と options.js）

`options.html`ファイルと`options.js`ファイルは、拡張機能のオプションページを構成します。オプションページでは、ユーザーがダークモードを永続的に有効または無効にすることができます。

- `options.html`：オプションページの HTML 構造を定義
- `options.js`：オプションの保存と復元を担当するスクリプト

## 動作の流れ

1. ユーザーが拡張機能のアイコンをクリックすると、`background.js`がアイコンのクリックイベントを受け取り、ダークモードのオン/オフを切り替える。
2. `background.js`は、`chrome.storage.sync`を使用してダークモードの状態を保存し、アイコンのタイトルを更新する。
3. `background.js`は、`chrome.scripting.executeScript`を使用して`content.js`をアクティブなタブにインジェクトする。
4. `content.js`は、`chrome.storage.sync`からダークモードの状態を読み込み、`<body>`要素にクラスを追加/削除してダークモードを適用する。
5. ユーザーがオプションページでダークモードを永続的に有効/無効にすると、`options.js`が`chrome.storage.sync`を使用してその設定を保存する。
6. `background.js`は、`chrome.storage.onChanged`イベントを監視し、ダークモードの状態が変更されたときに他のタブに変更を反映する。

## 注意点

- この拡張機能は、Manifest V3 を使用しています。Manifest V2 とは異なる点があるため、注意が必要です。
- `chrome.storage.sync`を使用するには、`"storage"`パーミッションが必要です。
- `chrome://`で始まるURLを含むタブには、拡張機能を適用できません。
- ダークモードのスタイルは、`dark_mode.css`で定義されています。必要に応じてスタイルを追加・修正してください。

## 今後の改善点

- ユーザーが特定のウェブサイトに対してダークモードを無効にできるようにする
- ダークモードのカラーテーマをカスタマイズできるようにする
- キーボードショートカットでダークモードのオン/オフを切り替えられるようにする
- ダークモードの適用をより詳細に制御できるようにする（特定の要素を除外するなど）

以上が、Dark Mode for Chrome 拡張機能の開発者ドキュメントです。ご不明な点やご提案があれば、お気軽にお問い合わせください。